<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SEKAR FİLO LASTİK HAK TAKİP</title>

  <script>
  (function(){
    function __pcDecodeLabel(label){
      if (!label || label.slice(0,4)!=='xn--') return label;
      var base=36,tmin=1,tmax=26,damp=700,initial_bias=72;
      function digit(cp){return cp-48<10?cp-22:cp-65<26?cp-65:cp-97<26?cp-97:base;}
      function adapt(delta,numPoints,firstTime){
        delta = firstTime ? Math.floor(delta/damp) : delta>>1;
        delta += Math.floor(delta/numPoints);
        var k=0; while (delta > (((base - tmin) * tmax) >> 1)) { delta = Math.floor(delta / (base - tmin)); k += base; }
        return k + Math.floor(((base - tmin + 1) * delta) / (delta + 38));
      }
      var n=128,i=0,bias=initial_bias; var dash=label.lastIndexOf('-'); var output=[]; var idx=4;
      if (dash>4){ for (var j=4;j<dash;j++) output.push(label.charCodeAt(j)); idx=dash+1; }
      while (idx<label.length){
        var oldi=i,w=1,k=base;
        while(true){
          if(idx>=label.length) return label;
          var d=digit(label.charCodeAt(idx++));
          i+=d*w;
          var t = k<=bias ? tmin : (k>=bias+tmax ? tmax : k-bias);
          if(d<t) break;
          w*=(base-t);
        }
        var outLen=output.length+1;
        bias=adapt(i-oldi,outLen,oldi===0);
        n+=Math.floor(i/outLen);
        i%=outLen;
        output.splice(i,0,n);
        i++;
      }
      return String.fromCharCode.apply(null, output);
    }
    window.emailNormalize = function(email){
      try{
        var s = String(email||'').trim();
        var at = s.indexOf('@'); if (at<0) return s;
        var local = s.slice(0,at);
        var domain = s.slice(at+1);
        var uni = domain.split('.').map(__pcDecodeLabel).join('.');
        try { uni = uni.toLowerCase().normalize('NFC').replace(/i̇/g,'i'); } catch(e){}
        return local + '@' + uni;
      }catch(e){ return String(email||'').trim(); }
    };
  })();
  </script>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body class="bg-gray-50 text-gray-900">
  <div id="root"></div>
  <script type="text/babel">
    const { useEffect, useMemo, useRef, useState } = React;
    const XLSX = window.XLSX;

    const TR_ILLER=["Adana","Adıyaman","Afyonkarahisar","Ağrı","Aksaray","Amasya","Ankara","Antalya","Ardahan","Artvin","Aydın","Balıkesir","Bartın","Batman","Bayburt","Bilecik","Bingöl","Bitlis","Bolu","Burdur","Bursa","Çanakkale","Çankırı","Çorum","Denizli","Diyarbakır","Düzce","Edirne","Elazığ","Erzincan","Erzurum","Eskişehir","Gaziantep","Giresun","Gümüşhane","Hakkari","Hatay","Iğdır","Isparta","İstanbul","İzmir","Kahramanmaraş","Karabük","Karaman","Kars","Kastamonu","Kayseri","Kırıkkale","Kırklareli","Kırşehir","Kilis","Kocaeli","Konya","Kütahya","Malatya","Manisa","Mardin","Mersin","Muğla","Muş","Nevşehir","Niğde","Ordu","Osmaniye","Rize","Sakarya","Samsun","Siirt","Sinop","Sivas","Şanlıurfa","Şırnak","Tekirdağ","Tokat","Trabzon","Tunceli","Uşak","Van","Yalova","Yozgat","Zonguldak"];

    const LS_KEY  = "lastik_takip_v1";
    const FMT = /^(\d{2})\.(\d{2})\.(\d{2})$/;
    const pad2 = n => String(n).padStart(2,"0");
    const fmt  = d => `${pad2(d.getDate())}.${pad2(d.getMonth()+1)}.${d.getFullYear().toString().slice(-2)}`;
    const today= () => fmt(new Date());
    function toDate(s){
      const m = FMT.exec(String(s ?? "")); if(!m) return null;
      const d = new Date(`${2000+ +m[3]}-${m[2]}-${m[1]}T00:00:00`);
      if(isNaN(d)) return null;
      if(d.getDate()!=+m[1]||d.getMonth()+1!=+m[2]) return null;
      return d;
    }
    const daysInc=(a,b)=>Math.floor((b-a)/86400000)+1;
    const prorata=(yk,s,e)=>{ const ds=toDate(s), de=toDate(e); if(!ds||!de||de<ds) return 0; return yk*(daysInc(ds,de)/365); };
    
function normExcelDate(v){
  try{
    if(v==null || v==="") return "";
    if(typeof v==="number" && XLSX && XLSX.SSF && XLSX.SSF.parse_date_code){
      const o = XLSX.SSF.parse_date_code(v);
      if(o && o.y && o.m && o.d) return fmt(new Date(o.y, o.m-1, o.d));
    }
    const raw = String(v).trim();
    if(!raw) return "";
    if(FMT.test(raw)) return raw;

    let s = raw.replace(/\s*[/\-.]\s*/g,'/');
    let m = /^(\d{1,2})\/(\d{1,2})\/(\d{2,4})$/.exec(s);
    if(m){
      let d = parseInt(m[1],10), mo = parseInt(m[2],10), y = parseInt(m[3],10);
      if(y < 100) y = 2000 + y;
      const dt = new Date(y, mo-1, d);
      if(!isNaN(dt)) return fmt(dt);
    }
    m = /^(\d{4})-(\d{2})-(\d{2})$/.exec(raw);
    if(m){
      const dt = new Date(parseInt(m[1],10), parseInt(m[2],10)-1, parseInt(m[3],10));
      if(!isNaN(dt)) return fmt(dt);
    }
    const dt = new Date(raw);
    if(!isNaN(dt)) return fmt(dt);
    return raw;
  }catch(e){
    return String(v);
  }
}

    function download(name, text){
      const a=document.createElement("a");
      a.href=URL.createObjectURL(new Blob([text],{type:"text/plain;charset=utf-8"}));
      a.download=name; a.click(); setTimeout(()=>URL.revokeObjectURL(a.href),1000);
    }
    function csvSafe(v){ const s = String(v ?? ''); return (/^[=+@-]/).test(s) ? "'" + s : s; }
    function normalizeTR(s){ try{ return String(s||'').toLowerCase().normalize('NFC').replace(/ş/g,'s').replace(/ı/g,'i').trim(); }catch{ return String(s||'').toLowerCase().trim(); } }

    // ... (the rest of the code remains exactly as in your provided sample)
  </script>
</body>
</html>
